<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<script type="application/javascript">

//En este array guardamos las personas
let personas = []

function vaciarFormulario(){
    nombre.value    = ''
    direccion.value = ''
    telefono.value  = ''
    correoE.value   = ''
}

function insertar(){

    let persona = {
        _id       : Math.round(Math.random()*1000000),
        nombre    : nombre.value,
        direccion : direccion.value,
        telefono  : telefono.value,
        correoE   : correoE.value
    }

    personas.push(persona)
    console.log(personas)

    vaciarFormulario()
    rellenarTabla()
}

function seleccionarPersona(id){
    alert("SEL:"+id)



}

function rellenarTabla(){

    tablaPersonas.innerHTML = ""

    /*
    for(let persona of personas){
        let tr = `
            <tr onclick='seleccionarPersona(persona._id)'>
                <td>${persona.nombre}</td>
                <td>${persona.direccion}</td>
                <td>${persona.telefono}</td>
                <td>${persona.correoE}</td>
            </tr>`;
        tablaPersonas.innerHTML = tablaPersonas.innerHTML + tr
    }
    */

    personas.forEach(function(persona){
        let tr = `<tr>
                <td>${persona.nombre}</td>
                <td>${persona.direccion}</td>
                <td>${persona.telefono}</td>
                <td>${persona.correoE}</td>
            </tr>`;

        //ÑAPA
        let tbody = document.createElement("tbody")
        tbody.innerHTML = tr
        let nodoTR = tbody.childNodes[0]

        //Closure: una funcion que utiliza una variable declarada fuera de ella
        nodoTR.onclick = function(){
            seleccionarPersona(persona._id)
        }

        tablaPersonas.append(nodoTR)

    })

}


window.onload = function(){
    btnVaciar.onclick = vaciarFormulario
    btnInsertar.onclick = insertar
}

</script>

<body>

    <h1 align="center">
        <font color="lightGreen">
            AgendaGest 3000     
        </font>
    </h1>

    <div align="center">
        <input type="button" id="btnInsertar"  value="Insertar"/>
        <input type="button" id="btnModificar" value="Modificar"/>
        <input type="button" id="btnBorrar"    value="Borrar"/>
        <input type="button" id="btnVaciar"    value="Vaciar"/>
        <input type="button" id="btnGuardar"   value="GUARDAR"/>
    </div>

    <br/>

    <form id="formulario">
        <table align="center">
            <tr>
                <td>Nombre</td>
                <td>
                    <input type="text" name="nombre" id="nombre"/>
                </td>  
                <td id="msj_nombre"></td>              
            </tr>
            <tr>
                <td>Dirección</td>
                <td>
                    <input type="text" name="direccion" id="direccion"/>
                </td>                
                <td id="msj_direccion"></td>              
            </tr>
            <tr>
                <td>Telefono</td>
                <td>
                    <input type="text" name="telefono" id="telefono"/>
                </td> 
                <td id="msj_telefono"></td>              
            </tr>
            <tr>
                <td>Correo E</td>
                <td>
                    <input type="text" name="correoE" id="correoE"/>
                </td>                
                <td id="msj_correoE"></td>              
            </tr>
        </table>        
    </form>

    <br/>

    <table align="center" border="1">
        <tr>
            <th>Nombre</th>
            <th>Dirección</th>
            <th>Teléfono</th>
            <th>Correo E</th>
        </tr>
        <tbody id="tablaPersonas"></tbody>
    </table>








</body>

</html>