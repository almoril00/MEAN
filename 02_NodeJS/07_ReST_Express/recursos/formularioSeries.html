<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="/jquery.js" type="application/javascript"></script>
    <link type="text/css" rel="styleSheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
</head>

<script tpye="application/javascript">

function insertarSerie(){

    /*
    let serie = {
        titulo   : $("#titulo"),
        genero   : $("#genero"),
        year     : $("#year"),
        pais     : $("#pais"),
        sinopsis : $("#sinopsis")
    }
    */

    let serie = {}
    $("#formulario [campo]")
        .each(function(){
            serie[this.id] = this.value
        })

    $.ajax({
        type : 'post',
        url  : '/series',
        contentType : 'application/json',
        data : JSON.stringify(serie)
    })
    .done(temporal)
    .fail(procesarError)

}

function temporal(){
    console.log(arguments)
    //window.location = "listadoSeries.html"
}

function procesarError(error){
    console.log(error)
}

function vaciarFormulario(){
    /*
    $("#titulo").val("")
    $("#genero").val("")
    $("#year").val("")
    $("#pais").val("")
    $("#sinopsis").val("")
    */

    $("#formulario [campo]").val('')
}

function verListadoSeries(){
    window.location = 'listadoSeries.html'
}

//////////////////
//Inicialización//
//////////////////

$(inicializar)

function inicializar(){
   //Se añaden los eventos
    $("#btnCancelar").click(verListadoSeries)
    $("#btnVaciar").click(vaciarFormulario)
    $("#btnInsertar").click(insertarSerie)

    /*    
    //
    //Pasando el _id entre las páginas utilizando el sessionStorage
    //
    //Miramos en el sessionStorage si nos han dejado un _id
    if(sessionStorage.getItem("_id_serie")){
        //ya tenemos el id
        //llamadita a cargar los datos de la serie
        //Borramos el _id del storage porque es una información de un solo uso
        sessionStorage.removeItem("_id_serie")
    }
    */

    //
    //Pasando el _id entre las páginas usando parámetros en la URL
    //

    /*
    -averiguar si en la url hay un parámetro llamado '_id'
        -troceando window.location (usaremos el '=' como atajo)
        -http://localhost:6001/formularioSeries.html?_id=5f774aa3d0163906e430313b
    -si no hay id pues nada, formulario vacío y botón modificar y borrar deshabilitados
    -si hay _id cargar el formulario y deshabilitar el botón insertar
        -petición AJAX al lugar adecuado
        -rellenar las cajas de texto
    */

s


    


    */

}

</script>

<body>
    
    <div class="jumbotron">
        <marquee>
            <h1>SeriesGest 3000</h1>
        </marquee>
    </div>
    
    <div class="text-center mt-2 mb-2">
        <button class="btn btn-primary mr-1" id="btnInsertar">Insertar</button>
        <button class="btn btn-primary mr-1" id="btnModificar">Modificar</button>
        <button class="btn btn-danger  mr-1" id="btnBorrar">Borrar</button>
        <button class="btn btn-warning mr-1" id="btnVaciar">Vaciar</button>
        <button class="btn btn-warning mr-1" id="btnCancelar">Cancelar</button>
    </div>

    <div class="row">

        <div class="col-sm-0 col-lg-2"></div>

        <div class="col-sm-12 col-lg-8"> 

            <!--$("#formulario [campo]")-->
            <div class="row" id="formulario">  

                <div class="col-2 mt-1">
                    <label>Título</label>
                </div>
                <div class="col-10 mt-1">
                    <input class="form-control" campo="" id="titulo"/>
                </div>

                <div class="col-2 mt-1">
                    <label>Genero</label>
                </div>
                <div class="col-10 mt-1">
                    <input class="form-control" campo="" id="genero"/>
                </div>

                <div class="col-2 mt-1">
                    <label>Año</label>
                </div>
                <div class="col-10 mt-1">
                    <input class="form-control" campo="" id="year"/>
                </div>
             
                <div class="col-2 mt-1">
                    <label>País</label>
                </div>
                <div class="col-10 mt-1">
                    <input class="form-control" campo="" id="pais"/>
                </div>                 

                <div class="col-2 mt-1">
                    <label>Sinopsis</label>
                </div>
                <div class="col-10 mt-1">
                    <textarea class="form-control" campo="" id="sinopsis"></textarea>
                </div>                 
            </div>         
        </div>
    </div>

</body>
</html>